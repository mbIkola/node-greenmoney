{"version":3,"sources":["GreenMoney.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","default","_extends2","_keys","_stringify","_assign","_classCallCheck2","_createClass2","_utils","request","usps","xml2js","parseString","DraftResponse","params","Result","undefined","ResultDescription","VerifyResult","VerifyResyltDescription","CheckNumber","Check_ID","x","DraftResult","original","key","toObject","res","toJSON","GreenMoney","clientId","apiPassword","apiUrl","oneTimeDraftRTV","name","phone","address1","city","state","zip","routingNumber","accountNumber","bankName","checkAmount","additionalOpts","opts","console","log","forEach","validateNotEmpty","validateNumber","rules","validateRegExp","validateUSPSState","apiCall","method","_this","formData","capitalizeFirstCharAtKeys","Client_ID","ApiPassword","post","url","form","headers","resolveWithFullResponse","then","response","formatResponseBody","body","status","Error","statusText","test","_default"],"mappings":"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CAAUJ,SAASK,UAAnB,CAAN;AACD,OAH0C,CAGzC;;;AAGF,UAAI,mBAAmBC,IAAnB,CAAwBN,SAASE,IAAjC,CAAJ,EAA4C;AAC1CvB,gBAAQC,GAAR,CAAY,8BAAZ,EAA4CoB,SAASE,IAArD;AACA,cAAM,IAAIE,KAAJ,CAAUJ,SAASE,IAAnB,CAAN;AACD;;AAED,aAAO,IAAI1D,MAAJ,CAAWwD,SAASE,IAApB,CAAP;AACD;AAdA,GAtDoC,CAAvC;AAsEA,SAAOxC,UAAP;AACD,CA3GD,EAFA;;AA+GA,IAAI6C,WAAW7C,UAAf;AACA9B,QAAQE,OAAR,GAAkByE,QAAlB,C,CAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GreenMoney.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime/core-js/object/keys\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime/core-js/json/stringify\"));\n\nvar _assign = _interopRequireDefault(require(\"@babel/runtime/core-js/object/assign\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _utils = require(\"./utils\");\n\nvar request = require('request-promise-native'); //request.debug = true;\n\n\nvar usps = require('us-states');\n\nvar xml2js = require('xml2js').parseString;\n\nvar DraftResponse =\n/*#__PURE__*/\nfunction () {\n  function DraftResponse(params) {\n    (0, _classCallCheck2.default)(this, DraftResponse);\n    this.Result = undefined;\n    this.ResultDescription = undefined;\n    this.VerifyResult = undefined;\n    this.VerifyResyltDescription = undefined;\n    this.CheckNumber = undefined;\n    this.Check_ID = undefined;\n\n    for (var x in params.DraftResult) {\n      this[x] = params.DraftResult[x];\n    }\n\n    this.original = params;\n  }\n\n  (0, _createClass2.default)(DraftResponse, [{\n    key: \"toObject\",\n    value: function toObject() {\n      var res = (0, _assign.default)({}, this);\n      delete res.original;\n      return res;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return (0, _stringify.default)(this.toObject());\n    }\n  }]);\n  return DraftResponse;\n}();\n\nvar GreenMoney =\n/*#__PURE__*/\nfunction () {\n  function GreenMoney(clientId, apiPassword) {\n    (0, _classCallCheck2.default)(this, GreenMoney);\n    this.clientId = clientId;\n    this.apiPassword = apiPassword;\n    this.apiUrl = 'https://www.greenbyphone.com/eCheck.asmx';\n  }\n  /**\n   * ONETIMEDRAFTRTV – ONE-TIME DRAFT REAL-TIME VERIFICATION\n   * OneTimeDraftRTV allows you to enter a single one-time draft check with real-time verification. OneTimeDraftRTV\n   * shares the same inputs and outputs as OneTimeDraftBV.\n   *\n   * @param name {string} Your customer’s name on their checking account.\n   * @param phone {string} Your customer’s 10-digit phone number in the format 999-999-9999.\n   * @param address1 {string} Your customer’s street number and street name.\n   * @param city {string} Your customer’s city.\n   * @param state {string} Your customer’s TWO DIGIT state abbreviation (ex: GA, NY, FL, CA, etc.). @see us-states npm package for details\n   * @param zip {string} Your customer’s 5-digit or 9-digit zip code in the format 99999 or 99999-9999.\n   * @param routingNumber {string} Your customer’s 9-digit bank routing number.\n   * @param accountNumber {string} Your customer’s bank account number\n   * @param bankName {string} Your customer’s bank name (ex: Wachovia, BB&T, etc.)\n   * @param checkAmount {Number} Check amount in the format 99.99. Do not include Monetary Symbols like $.\n   * @param additionalOpts {object} Optionally you can override some additional options listed below:\n   *  • EmailAddress - Your customer’s email address. Used for notification process. Note: This is not required,\n   *    but if it is not provided, notification will be made via US Mail at an additional cost. Contact Customer\n   *    service for details.\n   *  • PhoneExtension – Your customer’s phone extension.\n   *  • Address2 - Your customer’s additional address information (ex: Suite #, Floor #, etc.).\n   *  • Country - Your customer’s 2-character country code, ex: “US”. \"US\" by default.\n   *  • CheckMemo – Memo section from your customer’s check\n   *  • CheckDate* - Check date in the format mm/dd/yyyy. Check date can be from 2 months prior to 1 year in the future. 2 months from now by default\n   *\n   * @return {Promise<DraftResponse>}\n   */\n\n\n  (0, _createClass2.default)(GreenMoney, [{\n    key: \"oneTimeDraftRTV\",\n    value: function oneTimeDraftRTV(name, phone, address1, city, state, zip, routingNumber, accountNumber, bankName, checkAmount, additionalOpts) {\n      var opts = {\n        name: name,\n        phone: phone,\n        address1: address1,\n        city: city,\n        state: state,\n        zip: zip,\n        routingNumber: routingNumber,\n        accountNumber: accountNumber,\n        bankName: bankName\n      };\n      console.log(\"Opts: \", opts);\n      (0, _keys.default)(opts).forEach(function (name) {\n        return (0, _utils.validateNotEmpty)(name, opts[name]);\n      });\n      checkAmount = (checkAmount * 100 | 0) / 100.0;\n      (0, _utils.validateNumber)('checkAmount', checkAmount);\n      opts.checkAmount = checkAmount;\n      var rules = {\n        zip: /^[0-9]{5}(?:-[0-9]{4})?$/,\n        phone: /^[0-9]{3}-[0-9]{3}-[0-9]{4}$/,\n        state: /^[a-zA-Z]{2}$/\n      };\n      (0, _keys.default)(rules).forEach(function (name) {\n        return (0, _utils.validateRegExp)(name, rules[name], opts[name]);\n      });\n      (0, _utils.validateUSPSState)(opts.state);\n      opts = (0, _extends2.default)({}, opts, additionalOpts);\n      return this.apiCall('OneTimeDraftRTV', opts);\n    }\n  }, {\n    key: \"apiCall\",\n    value: function apiCall(method, params) {\n      var _this = this;\n\n      var formData = (0, _utils.capitalizeFirstCharAtKeys)(params);\n      formData.Client_ID = this.clientId;\n      formData.ApiPassword = this.apiPassword;\n      return request.post({\n        url: this.apiUrl,\n        form: formData,\n        headers: {\n          'Accept': 'application/xml'\n        },\n        resolveWithFullResponse: true\n      }).then(function (response) {\n        return _this.formatResponseBody(response);\n      }).then(function (body) {\n        return new DraftResponse(body);\n      });\n    }\n  }, {\n    key: \"formatResponseBody\",\n    value: function formatResponseBody(response) {\n      if (response.status >= 400) {\n        throw new Error(response.statusText);\n      } //console.log(\"GreenMoney Response;\", response, response.body);\n\n\n      if (/Request Rejected/.test(response.body)) {\n        console.log(\"GreenMoney Request rejected:\", response.body);\n        throw new Error(response.body);\n      }\n\n      return new xml2js(response.body);\n    }\n  }]);\n  return GreenMoney;\n}();\n\nvar _default = GreenMoney;\nexports.default = _default; //# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map\n//# sourceMappingURL=GreenMoney.js.map"]}